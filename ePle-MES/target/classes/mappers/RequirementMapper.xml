<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- RequirementMapper.xml -->
<mapper namespace="com.itwillbs.mapper.RequirementMapper">

    <!-- 디비 컬럼과 도메인 객체 매핑 -->
    <!-- 프로퍼티명과 컬럼명 동일 시 생략가능  -->
    <resultMap type="com.itwillbs.domain.MAPDVO" id="requirement">
    	<result property="code" column="code"/>
    	<result property="group_id" column="group_id"/>
    	<result property="code_id" column="code_id"/>
    	<result property="name" column="name"/>
    	<result property="size" column="size"/>
    	<result property="unit" column="unit"/>
    	<result property="inprice" column="inprice"/>
    	<result property="outprice" column="outprice"/>
    	<result property="reg_emp" column="reg_emp"/>
    	<result property="reg_date" column="reg_date"/>
    	<result property="update_emp" column="update_emp"/>
    	<result property="update_date" column="update_date"/>
    	<result property="active" column="active"/>
    </resultMap>
    
    <resultMap type="com.itwillbs.domain.OrderVO" id="order">
    	<result property="material" column="material"/>
    </resultMap>

    <!-- 소요량 리스트 전체 조회 -->
    <select id="selectRequirementList" resultMap="requirement">
		SELECT MAPD.*, ORDERS.*
		FROM MAPD
		LEFT outer JOIN ORDERS ON MAPD.code = ORDERS.material
	</select>

    <!-- 소요량 등록 -->
    <insert id="insertRequirement" parameterType="com.itwillbs.domain.MAPDVO">
	    INSERT INTO MAPD (code, name, material, requirement, reg_emp, reg_date, update_emp, update_date, active) 
	    VALUES (#{code}, #{name}, #{material}, #{requirement}, #{reg_emp}, #{reg_date}, #{update_emp}, #{update_date}, #{active})
	</insert>

    <!-- 소요량 수정 -->
    <update id="updateRequirement">
        UPDATE MAPD SET group_id = #{group_id}, name = #{name}, material = #{material}, requirement = #{requirement}, reg_emp = #{reg_emp}, reg_date = #{reg_date}, update_emp = #{update_emp}, update_date = #{update_date}, active = #{active}  
        where group_id = #{group_id}
    </update>
    
    <!-- 특정 번호 글 조회 -->
  	<select id="getRequirement" resultType="MAPDVO">
  		select * from MAPD 
  		where group_id = #{group_id} 	
  	</select>

    <!-- 소요량 삭제 -->
	<delete id="deleteRequirements" parameterType="string">
	    DELETE FROM MAPD WHERE code IN
	    <foreach collection="array" item="code" open="(" separator="," close=")">
	        #{group_id}
	    </foreach>
	</delete>
	
	<select id="getInfo" resultType="MAPDVO" parameterType="string">
        SELECT * FROM MAPD WHERE code IN
        <foreach collection="array" item="code" open="(" separator="," close=")">
            #{code}
        </foreach>
    </select>
    
    <!-- 전체 소요량 수 조회 -->
  	<select id="countRequirement" resultType="int">
  <![CDATA[
  	select count(*) from MAPD where 1=1
  ]]>
	</select>
	
	<!-- 소요량 검색 -->

</mapper>
